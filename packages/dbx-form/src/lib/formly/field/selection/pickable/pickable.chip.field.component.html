<div class="dbx-pickable-item-field">
  <dbx-loading [context]="context">
    <ng-container *ngIf="showFilterInput">
      <ng-container *ngTemplateOutlet="filterTemplate"></ng-container>
    </ng-container>
    <div class="dbx-pickable-item-field-chips">
      <!-- TODO: Add back aria-label  [attr.aria-label]="'email ' + emailParticipantsType" -->
      <mat-chip-list [selectable]="!readonly" [disabled]="readonly" #chipList>
        <mat-chip *ngFor="let item of items$ | async" (click)="itemClicked(item)" [selected]="item.selected">
          <span class="s-chip-label">{{ item.display.label }}</span>
        </mat-chip>
      </mat-chip-list>
      <dbx-injected-content [config]="footerConfig"></dbx-injected-content>
    </div>
  </dbx-loading>
</div>

<!-- Filter Input -->
<ng-template #filterTemplate>
  <div class="dbx-pickable-item-field-filter">
    <mat-form-field class="dbx-pickable-item-field-filter-field" appearance="fill">
      <mat-label>{{ filterLabel }}</mat-label>
      <input name="filter items" #filterMatInput="matInput" matInput [placeholder]="placeholder"
        [formControl]="inputCtrl">
    </mat-form-field>
    <div class="searchable-field-form-loading">
      <dbx-loading [linear]="true" [context]="filterResultsContext"></dbx-loading>
    </div>
  </div>
</ng-template>
